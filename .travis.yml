language: go
go:
  - 1.12.x
  - master

matrix:
  allow_failures:
    - go: master

# script:
# - go run main.go

before_deploy:
  - export XCOMPILE='go build -o hcl2json_${TRAVIS_TAG}_${GOOS}_${GOARCH}${EXT} -ldflags="-X main.Version=${TRAVIS_TAG}" github.com/tmccombs/hcl2json'
  - GOOS=linux   GOARCH=386            eval "$XCOMPILE"
  - GOOS=linux   GOARCH=amd64          eval "$XCOMPILE"
  - GOOS=linux   GOARCH=arm            eval "$XCOMPILE"
  - GOOS=darwin  GOARCH=386            eval "$XCOMPILE"
  - GOOS=darwin  GOARCH=amd64          eval "$XCOMPILE"
  - GOOS=windows GOARCH=386   EXT=.exe eval "$XCOMPILE"
  - GOOS=windows GOARCH=amd64 EXT=.exe eval "$XCOMPILE"
deploy:
  provider: releases
  api_key:
    secure: QrI0NZbxapQwBvcRkbBGU4uE0s6Hma/ELlK4y0cEkPH4tRbckW+tTFg6T5q72QhoIDNb0FIGNEwPG07X35OAGZjKjRWnyqMmuCAS2VWuIP+sAzCPp+T4NuOOaGsaY60+TPh+AUykVJKgGyw4aEKtYHk00SGlYfA0WOotS2dV42M1oL0QB6mkFqKJc4IqZzum0mRzDNpjUfNGr+vFNIbTR/bTcTU/VK9VLc1BBTkJRLA0uY4Y2nVDrRq6RQ+Mjb1WpusXMGi9T7q8CfUHPbveJ65A615PhNw65GYmAv9GM6N6KZvModQJzLNAG9Hjtzr4dSmxChhPWOKmBIIN7hOdlB5jQuxecPxXIHyp/ZY6GyRnEWoFzx2APibbW5iXEnpbXyzcQjpBDWtaADKKBfwoamHilM4vRpORpCH2TO6Ujb1trvU/CBNT/NRJPJHxeFT+E17ERYprFzIECyk2KH42oYtJlfXUxS4E+/1PPvHnPWydNvjrr5GpLOuX6NV3fnkBNchltY7OSa7GqysCNcLtXTeL+QBDaCk7+ypWnG4gRkiEkYd8aIaPHBMEdOK0pyVS1RoLesE7FQ5/2FlLSLFndatlLHWUy+M/eK2qhc1r+BhOmjL46x+NmxVOYIdNgyg8E/y49lCvxW+7jr1W5UmY/AQKRAzWLKM4Z/m2MgRxN6s=
  file_glob: true
  file: hcl2json_*
  skip_cleanup: true
  on:
    tags: true
    go: 1.12.x
    repo: tmccombs/hcl2json
